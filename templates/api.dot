module AWS.{{= it.mod }}
    exposing
        ( {{= it.operations.map(op => op.name).join('\n        , ')}}
        , {{= it.types.filter(t => t.exposeAs).map(t => t.exposeAs).join('\n        , ')}}
        )

{-| {{= it.documentation }}

## Table of Contents

* [Operations](#operations){{~ it.categories :c }}
* [{{= c.name }}](#{{= c.name.toLowerCase() }}){{~}}

## Operations

{{~ it.operations.map(op => op.name) :name }}* [{{= name }}](#{{= name }})
{{~}}

@docs {{= it.operations.map(op => op.name).join(',') }}
{{~ it.categories :c }}
## {{= c.name }}

@docs {{= c.types.filter(t => t.exposeAs).map(t => t.type).join(',') }}
{{~}}
-}

import Http
import Json.Decode as JD
import Json.Decode.Pipeline as JDP
{{~ it.extraImports :importExtra }}{{= importExtra }}
{{~}}

-- OPERATIONS
{{~ it.operations :op }}

{-| {{= op.doc }}
{{? op.input && op.input.members }}
__Parameters__

{{~ op.input.members :m }}* `{{= m.key }}` __:__ `{{= m.value.type }}`
{{~}}
{{?}}
-}
{{= op.name }} : {{? op.input }}{{~ op.input.members :m }}{{= m.value.type }} -> {{~}}{{?}}Http.Request {{= op.output.type }}
{{= op.name }} {{? op.input }}{{~ op.input.members :m }}{{= m.key }} {{~}}{{?}}=
    Http.request
        { method = "{{= op.http.method }}"
        , headers = []
        , url = "{{= op.http.requestUri }}"
        , body = Http.emptyBody -- TODO: replace with op.input encoded as json
        , expect = Http.expectJson {{= op.output.decoder }}
        , timeout = Nothing
        , withCredentials = False
        }
{{~}}

{{~ it.types.filter(t => t.exposeAs) :t }}
{{= t.typeDef }}

{{? t.decoderDef }}
{{= t.decoderDef }}
{{?}}
{{~}}
